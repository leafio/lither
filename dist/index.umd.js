!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).index={})}(this,(function(e){"use strict";const t=e=>{var t;const r=[];return null===(t=e.match(/\:([^:\/\d]+)\/?/g))||void 0===t||t.forEach((e=>{r.push(e.replace(/\//g,"").replace(/:/g,""))})),r};function r(e,r={},o){const n="Content-Type";let s={isTimeout:!1},i=null==o?void 0:o.timeout,a={...r,timeout:i};const{beforeRequest:l,afterResponse:u}=o||{};l&&(a=l(a));const c=new AbortController;let d=a.signal;a.signal=c.signal;const f=e=>{c.abort(e)};let h;null==d||d.addEventListener("abort",f),i=a.timeout,i&&(h=setTimeout((()=>{s.isTimeout=!0,c.abort("timeout")}),i));const p=()=>{h&&(clearTimeout(h),h=void 0),null==d||d.removeEventListener("abort",f)},m=(e,t,r)=>{u?u(e,{resolve:t,reject:r}):(e.ok&&t(e.body),r(e))};return new Promise(((r,i)=>{let l=e;if(t(e).forEach((e=>{a.params&&a.params[e]?l=l.replace(":"+e,""+a.params[e]):(s.error="need url path params key:"+e,m(s,r,i))})),a.query){const e=[];Object.entries(a.query).forEach((([t,r])=>{Array.isArray(r)?r.forEach((r=>{e.push([t,r])})):void 0!==r&&e.push([t,r])}));const t=new URLSearchParams(e);l=l+(l.includes("?")?"&":"?")+t,l.replace("&&","&")}let u=null==o?void 0:o.baseURL;u&&0!==l.trim().indexOf("http")&&(l=u+("/"===u[u.length-1]?"":"/")+("/"===l[0]?l.slice(1):l));let c=!1;const d=a.body;d&&(d instanceof Blob||d instanceof ArrayBuffer||d instanceof FormData||"string"==typeof d||(c=!0,a.body=JSON.stringify(d)));const f=a.headers||new Headers;let h=(null==o?void 0:o.auth)?o.auth():void 0;if(h)if("string"==typeof h)f.set("Authorization",h);else for(const[e,t]of h.entries())f.set(e,t);c&&f.set(n,"application/json"),a.headers=f,fetch(l,a).then((e=>{if(s={ok:e.ok,headers:e.headers,redirected:e.redirected,status:e.status,statusText:e.statusText,type:e.type,url:e.url,body:"",isTimeout:!1},a.responseHandler)return e[a.responseHandler]();{let t=e.headers.get(n);return(null==t?void 0:t.includes("json"))?e.json():e.text()}})).then((e=>{p(),s={...s,body:e},m(s,r,i)})).catch((e=>{p(),m({...s,error:e},r,i)}))}))}function o(e={}){const o=(t,n)=>{var s;return r(t,n,null!==(s=o.baseInit)&&void 0!==s?s:e)};o.baseInit=e;const s=(e,t)=>r(e,t,o.baseInit),i=["get","post","put","delete","patch"];return i.forEach((e=>{o[e]=(t,r,o)=>s(t,{["get"===e?"query":"body"]:r,method:e,...o})})),o.request=s,o.API=e=>{const r={},o=!!t(e).length;return i.forEach((t=>{const s=t.toUpperCase();r[s]=()=>(...r)=>{let[s,i]=r;return n[t](e,o?i:s,{params:o?s:void 0})}})),r},o}const n=o();e.createLither=o,e.lither=n,e.litherFetch=r}));
